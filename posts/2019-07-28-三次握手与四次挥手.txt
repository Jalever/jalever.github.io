1:HL["/_next/static/media/a34f9d1faa5f3315-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/_next/static/css/3e50223f751b8206.css",{"as":"style"}]
0:[[["",{"children":["posts",{"children":[["slug","2019-07-28-%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8E%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B","c"],{"children":["__PAGE__?{\"slug\":[\"2019-07-28-三次握手与四次挥手\"]}",{}]}]}]},"$undefined","$undefined",true],"$L3",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/3e50223f751b8206.css","precedence":"next"}]],["$L4",["$","meta",null,{"name":"next-size-adjust"}]]]]]
5:I{"id":"394","chunks":["485:static/chunks/485-3071997949e00430.js","185:static/chunks/app/layout-2e97076267892308.js"],"name":"ThemeProvider","async":false}
6:I{"id":"7749","chunks":["485:static/chunks/485-3071997949e00430.js","185:static/chunks/app/layout-2e97076267892308.js"],"name":"ModeToggle","async":false}
7:I{"id":"6485","chunks":["485:static/chunks/485-3071997949e00430.js","185:static/chunks/app/layout-2e97076267892308.js"],"name":"","async":false}
8:I{"id":"5813","chunks":["272:static/chunks/webpack-008eeab58a60626f.js","508:static/chunks/3949d24b-b3670977323a3ac7.js","604:static/chunks/604-576b6ce5c58b6c72.js"],"name":"","async":false}
9:I{"id":"8464","chunks":["272:static/chunks/webpack-008eeab58a60626f.js","508:static/chunks/3949d24b-b3670977323a3ac7.js","604:static/chunks/604-576b6ce5c58b6c72.js"],"name":"","async":false}
b:I{"id":"9422","chunks":["485:static/chunks/485-3071997949e00430.js","185:static/chunks/app/layout-2e97076267892308.js"],"name":"Analytics","async":false}
3:[["$","html",null,{"lang":"en","children":["$","body",null,{"className":"antialiased min-h-screen bg-white dark:bg-slate-950 text-slate-900 dark:text-slate-50 __className_a184c8","children":["$","$L5",null,{"attribute":"class","defaultTheme":"system","enableSystem":true,"children":[["$","div",null,{"className":"max-w-2xl mx-auto py-10 px-4","children":[["$","header",null,{"children":["$","div",null,{"className":"flex items-center justify-between","children":[["$","$L6",null,{}],["$","nav",null,{"className":"ml-auto text-sm font-medium space-x-6","children":[["$","$L7",null,{"href":"/","children":"Home"}],["$","$L7",null,{"href":"/about","children":"About"}]]}]]}]}],["$","main",null,{"children":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":"$undefined","childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":"$undefined","childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children","posts","children",["slug","2019-07-28-%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8E%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B","c"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","asNotFound":"$undefined","childProp":{"current":["$La",null],"segment":"__PAGE__?{\"slug\":[\"2019-07-28-三次握手与四次挥手\"]}"},"styles":[]}],"segment":["slug","2019-07-28-%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E4%B8%8E%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B","c"]},"styles":[]}],"segment":"posts"},"styles":[]}]}]]}],["$","$Lb",null,{}]]}]}]}],null]
4:[[["$","meta",null,{"charSet":"utf-8"}],["$","title",null,{"children":"2019-07-28-三次握手与四次挥手"}],["$","meta",null,{"name":"description","content":"一篇关于 TCP 协议中的三次握手和四次挥手过程，以及 TCP 连接的 11 种状态。"}],null,null,null,null,null,null,null,null,["$","meta",null,{"name":"viewport","content":"width=device-width, initial-scale=1"}],null,null,null,null,null,null,null,null,null,null,[]],[null,null,null,null],null,null,[null,null,null,null,null],null,null,null,null,[null,[["$","link",null,{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"any"}]],[],null]]
a:["$","article",null,{"className":"py-6 prose dark:prose-invert","children":[["$","h1",null,{"className":"mb-2","children":"2019-07-28-三次握手与四次挥手"}],["$","p",null,{"className":"text-xl mt-0 text-slate-700 dark:text-slate-200","children":"一篇关于 TCP 协议中的三次握手和四次挥手过程，以及 TCP 连接的 11 种状态。"}],["$","hr",null,{"className":"my-4"}],[["$","h2",null,{"children":"三次握手"}],"\n",["$","p",null,{"children":[["$","img",null,{"src":"https://s1.ax1x.com/2020/07/28/akfmDA.png","alt":"akfmDA.png"}],"\n三次握手过程说明："]}],"\n",["$","p",null,{"children":"1.由客户端发送建立TCP连接的请求报文，其中报文中包含seq序列号，是由发送端随机生成的，并且将报文中的SYN字段置为1，表示需要建立TCP连接。（SYN=1，seq=x，x为随机生成数值）"}],"\n",["$","p",null,{"children":"2.由服务端回复客户端发送的TCP连接请求报文，其中包含seq序列号，是由回复端随机生成的，并且将SYN置为1，而且会产生ACK字段，ACK字段数值是在客户端发送过来的序列号seq的基础上加1进行回复，以便客户端收到信息时，知晓自己的TCP建立请求已得到验证。（SYN=1，ACK=x+1，seq=y，y为随机生成数值）这里的ack加1可以理解为是确认和谁建立连接。"}],"\n",["$","p",null,{"children":"3.客户端收到服务端发送的TCP建立验证请求后，会使自己的序列号加1表示，并且再次回复ACK验证请求，在服务端发过来的seq上加1进行回复。（SYN=1，ACK=y+1，seq=x+1）"}],"\n",["$","h2",null,{"children":"四次挥手"}],"\n",["$","p",null,{"children":[["$","img",null,{"src":"https://s1.ax1x.com/2020/07/28/ak5EgU.png","alt":"ak5EgU.png"}],"\n1.客户端发送断开TCP连接请求的报文，其中报文中包含seq序列号，是由发送端随机生成的，并且还将报文中的FIN字段置为1，表示需要断开TCP连接。（FIN=1，seq=x，x由客户端随机生成）"]}],"\n",["$","p",null,{"children":"2.服务端会回复客户端发送的TCP断开请求报文，其包含seq序列号，是由回复端随机生成的，而且会产生ACK字段，ACK字段数值是在客户端发过来的seq序列号基础上加1进行回复，以便客户端收到信息时，知晓自己的TCP断开请求已经得到验证。（FIN=1，ACK=x+1，seq=y，y由服务端随机生成）"}],"\n",["$","p",null,{"children":"3.服务端在回复完客户端的TCP断开请求后，不会马上进行TCP连接的断开，服务端会先确保断开前，所有传输到A的数据是否已经传输完毕，一旦确认传输数据完毕，就会将回复报文的FIN字段置1，并且产生随机seq序列号。（FIN=1，ACK=x+1，seq=z，z由服务端随机生成）"}],"\n",["$","p",null,{"children":"4.客户端收到服务端的TCP断开请求后，会回复服务端的断开请求，包含随机生成的seq字段和ACK字段，ACK字段会在服务端的TCP断开请求的seq基础上加1，从而完成服务端请求的验证回复。（FIN=1，ACK=z+1，seq=h，h为客户端随机生成）"}],"\n",["$","p",null,{"children":"至此TCP断开的4次挥手过程完毕"}],"\n",["$","h2",null,{"children":"11种状态"}],"\n",["$","p",null,{"children":["$","img",null,{"src":"https://s1.ax1x.com/2020/07/28/ak7WOU.png","alt":"ak7WOU.png"}]}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":"一开始，建立连接之前服务器和客户端的状态都为CLOSED；"}],"\n",["$","li",null,{"children":"服务器创建socket后开始监听，变为LISTEN状态；"}],"\n",["$","li",null,{"children":"客户端请求建立连接，向服务器发送SYN报文，客户端的状态变味SYN_SENT；"}],"\n",["$","li",null,{"children":"服务器收到客户端的报文后向客户端发送ACK和SYN报文，此时服务器的状态变为SYN_RCVD；"}],"\n",["$","li",null,{"children":"然后，客户端收到ACK、SYN，就向服务器发送ACK，客户端状态变为ESTABLISHED；"}],"\n",["$","li",null,{"children":"服务器端收到客户端的ACK后变为ESTABLISHED。此时3次握手完成，连接建立！"}],"\n"]}],"\n",["$","p",null,{"children":[["$","img",null,{"src":"https://s1.ax1x.com/2020/07/28/akH1XT.png","alt":"akH1XT.png"}],"\n由于TCP连接是全双工的，断开连接会比建立连接麻烦一点点。"]}],"\n",["$","p",null,{"children":"1.客户端先向服务器发送FIN报文，请求断开连接，其状态变为FIN_WAIT1；\n2.服务器收到FIN后向客户端发送ACK，服务器的状态围边CLOSE_WAIT；\n3.客户端收到ACK后就进入FIN_WAIT2状态，此时连接已经断开了一半了。如果服务器还有数据要发送给客户端，就会继续发送；\n4.直到发完数据，就会发送FIN报文，此时服务器进入LAST_ACK状态；\n5.客户端收到服务器的FIN后，马上发送ACK给服务器，此时客户端进入TIME_WAIT状态；\n6.再过了2MSL长的时间后进入CLOSED状态。服务器收到客户端的ACK就进入CLOSED状态。"}],"\n",["$","p",null,{"children":"至此，还有一个状态没有出来：CLOSING状态。"}],"\n",["$","p",null,{"children":"CLOSING状态表示： 客户端发送了FIN，但是没有收到服务器的ACK，却收到了服务器的FIN，这种情况发生在服务器发送的ACK丢包的时候，因为网络传输有时会有意外"}],"\n",["$","h4",null,{"children":"全部状态"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"LISTEN：等待从任何远端TCP 和端口的连接请求。"}],"\n",["$","li",null,{"children":"SYN_SENT：发送完一个连接请求后等待一个匹配的连接请求。"}],"\n",["$","li",null,{"children":"SYN_RECEIVED：发送连接请求并且接收到匹配的连接请求以后等待连接请求确认"}],"\n",["$","li",null,{"children":"ESTABLISHED：表示一个打开的连接，接收到的数据可以被投递给用户。连接的数据传输阶段的正常状态"}],"\n",["$","li",null,{"children":"FIN_WAIT_1：等待远端TCP 的连接终止请求，或者等待之前发送的连接终止请求的确认"}],"\n",["$","li",null,{"children":"FIN_WAIT_2：等待远端TCP 的连接终止请求"}],"\n",["$","li",null,{"children":"CLOSE_WAIT：等待本地用户的连接终止请求"}],"\n",["$","li",null,{"children":"CLOSING：等待远端TCP 的连接终止请求确认"}],"\n",["$","li",null,{"children":"LAST_ACK：等待先前发送给远端TCP 的连接终止请求的确认（包括它字节的连接终止请求的确认）"}],"\n",["$","li",null,{"children":"TIME_WAIT：等待足够的时间过去以确保远端TCP 接收到它的连接终止请求的确认。"}],"\n",["$","li",null,{"children":"TIME_WAIT 两个存在的理由：- 可靠的实现tcp全双工连接的终止；- 允许老的重复分节在网络中消逝"}],"\n",["$","li",null,{"children":"CLOSED：不在连接状态（这是为方便描述假想的状态，实际不存在）"}],"\n"]}]]]}]
